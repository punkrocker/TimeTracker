@{
    ViewBag.Title = "title";
}
@section scripts{
    <script src="~/Scripts/echarts.min.js" type="text/javascript"></script>
    <script src="~/Scripts/html2canvas.min.js" type="text/javascript"></script>
}
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li>
            <a href="index.html">Report</a>
            <i class="fa fa-circle"></i>
        </li>
        <li>
            <span>Monthly Report</span>
        </li>
    </ul>
    <div class="page-toolbar">
        <button type="button" class="btn btn-success" onclick="exportReport();">Export</button>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <!-- BEGIN SAMPLE TABLE PORTLET-->
        <div class="portlet">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-bell-o"></i>Monthly Report
                </div>
            </div>
            <div id="report" class="portlet-body">
                <div class="text-center">
                    <p><h2><b>UnionServ Monthly Report</b></h2></p>
                    <p><h4><b><i>@ViewBag.customerTeams[0].CustomerName</i></b></h4></p>
                    <p><h4><b><i>UnionServ Unique Outsourcing Development Support - Four Stages of Outsourcing</i></b></h4></p>
                    <img src="~/Content/layouts/layout/img/report_img.png" />
                    <p><h4><b><i>FAQs & Advises</i></b></h4></p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Current Status: </span> We have been able to handle our back office workload in-house.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        While that may be true now, we know that the pressure is always on from both your clients and carriers to provide more service for the same cost. An insurance agency should analyze its core competencies and consider outsourcing everything else. With talent tough to come by, we help you to obtain talented, limited resources. When employees are overworked and overqualified, UnionServ may be a great way to retain employees by not requiring them to perform work for which they are overqualified. UnionServ could be used to increase morale and thus productivity. On the other hand, we extend your staff’s ability to produce more in a shorter time and at a lower cost.
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Multiple Systems: </span> We have many systems like management, rating, filing that are specific to our brokerage. It is not flexible to outsource.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        UnionServ access your systems directly using remote-access tools just like one of your remote employees. With many years operation experiences among retail brokers, MGAs and Carriers, UnionServ support most insurance system, below is a sample list of some of the systems we are using right now:
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Management Challenges: </span> What we need to do to improve margins with UnionServ?
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        Winning internal support from your existing staff is critical to success. Once they embrace the idea, realize that UnionServ's role is not to threaten their jobs but rather to support them and make their jobs more interesting and productive, they can, with management support, identify additional ways to free themselves from routine analysis and processing and improve productivity and their book of business.
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Our Goal: </span> Does Remote Staffing lead to downsizing? We are not looking to downsize our company.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        Most UnionServ clients haven’t downsized as a result of our solutions. They’ve grown. Clients we serve are not looking to lose valuable staff. Good staffs are hard to find and take time to train. That's why our Remote Staffing model is not about downsizing, but cost effective growth. <br/>
                        Our goal is to help best companies outsource to win, not to shrink. They outsource to innovate faster and more cheaply in order to grow larger, gain market share, and hire more and different specialists - not to save money by firing people.
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Time: </span> What time does it require of management to get something going? We're already so busy as it is.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        We understand that it is critical that implementation be minimally disruptive to management and staff. Implementation involves spending 2-3 days with a member of your staff documenting the workflows required to process the task, according to your procedures. We have been fully up and running with other clients in as little as a few weeks. Our clients are usually surprised just how easy and quick it is to get started. The only thing that can slow progress is if you do not have remote access capability either via the Internet, Terminal Services, Citrix etc.
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Cost: </span> We cannot afford to outsource.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        You probably can’t afford NOT to outsource. Our clients have lowered their labor costs by up to 50% without losing productivity. With a potential cost savings of 1-2% of total gross revenue, UnionServ is the choice that saves.
                    </p>
                    <div class="note note-info">
                        <p style="font-size: 15px; text-align: left">
                            <span style="color: red">Experiences: </span> I need a partner that understands the Insurance landscape, my business and my client’s need.
                        </p>
                    </div>
                    <p style="font-size: 14px; text-align: left">
                        UnionServ was founded by US Insurance processing professionals, experienced with retail brokers, MGAs and carriers’ tasks. UnionServ provides cost-effective solutions to time consuming operations and helps insurance agencies to reduce labor and E&O exposure costs. Our implementation team has many years of insurance industry and operations experience. <br/>
                        Our operations leaders are both industry experts and accomplished entrepreneurs that know that your business relies on the relationships you've built with your clients through trust and excellence.
                    </p>
                </div>
                <p style="font-size: 11px"><b><i>Thanks for your business.  UnionServ is your long term business partner.</i></b></p>
                <p style="font-size: 11px"><b><i>Please see following report in details. </i></b></p>
                <p style="font-size: 11px; text-align: right"><b><i>@ViewBag.currentMonth</i></b></p>
                <div id="task" style="height:800px;">
                </div>
                <div id="task_percent" style="height:800px;">
                </div>
                <div id="time" style="height:800px;">
                </div>
                <div id="time_percent" style="height:800px;">
                </div>
                <div style="text-align: center">
                    <p><h4><b>Monthly Summary</b></h4></p>
                    <div class="panel-heading bg-green bg-font-green">
                        <h3 class="panel-title" style="text-align: left">@ViewBag.customerTeams[0].CustomerName</h3>
                    </div>
                    <div class="panel-body">
                        <div class="col-md-4">
                            <p>Key Contact:</p>
                            <p><b>@ViewBag.customerTeams[0].Contact</b></p>
                        </div>
                        <div class="col-md-4">
                            <p>Transaction:</p>
                            <p><b>Dennis</b></p>
                        </div>
                        <div class="col-md-4">
                            <p>Time(min):</p>
                            <p><b>Dennis</b></p>
                        </div>
                        <div class="col-md-4">
                            <p>Team:</p>
                            <p><b>@ViewBag.customerTeams.Count</b></p>
                        </div>
                        <div class="col-md-4">
                            <p>Project:</p>
                            <p><b>Dennis</b></p>
                        </div>
                        <div class="col-md-4">
                            <p>Actual Processor Use:</p>
                            <p><b>Dennis</b></p>
                        </div>
                    </div>
                </div>
                <div >
                    @if (!ViewBag.comment.ToString().Trim().Equals(string.Empty))
                    {
                        <p><h4><b>Comment:</b></h4></p>
                        var comments = ViewBag.comment.Split('\n');
                        foreach (var comm in comments)
                        {
                            <span style="margin: 15px">@comm</span><br />
                        }
                    }
                </div>
                <br/>
            </div>
        </div>

    </div>
</div>
<script>

            function exportReport() {
                html2canvas(document.getElementById("report")).then(function (canvas) {
                    var url = canvas.toDataURL('image/png');
                    var a = document.createElement('a');
                    var event = new MouseEvent('click');
                    a.download = name || '生成报告';
                    a.href = url;
                    a.dispatchEvent(event);
                });
            }

            function getTask() {
                var taskChart = echarts.init(document.getElementById('task'));
                // 指定图表的配置项和数据
                option = {
                    title: {
                        text: 'Project Summary',
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        }
                    },
                    legend: {
                        data: ['Last Month', 'This Month']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01]
                    },
                    yAxis: {
                        type: 'category',
                        data:  @Html.Raw(Json.Encode(ViewBag.ProjectNames))
                    },
                    series: [
                        {
                            name: 'Last Month',
                            type: 'bar',
                            data: @Html.Raw(Json.Encode(ViewBag.LastTasks)),
                            label: {
                                normal: {
                                    show: true,
                                    position: 'right'
                                }
                            }
                        },
                        {
                            name: 'This Month',
                            type: 'bar',
                            data: @Html.Raw(Json.Encode(ViewBag.CurrentTasks)),
                            label: {
                                normal: {
                                    show: true,
                                    position: 'right'
                                }
                            }
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                taskChart.setOption(option);
            }

            function getTaskPercent() {
                var taskPercentChart = echarts.init(document.getElementById('task_percent'));
                var allTasks = @Html.Raw(Json.Encode(ViewBag.CurrentTasks));
                var allProjects =  @Html.Raw(Json.Encode(ViewBag.ProjectNames));
                projectData = [];
                for (var i = 0; i < allTasks.length; i++) {
                    var data = new Object();
                    data.name = allProjects[i];
                    data.value = allTasks[i];
                    projectData.push(data);
                }
                // 指定图表的配置项和数据
                option = {
                    title : {
                        text: 'Total Task',
                    },
                    tooltip : {
                        trigger: 'item',
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'right',
                        data:  @Html.Raw(Json.Encode(ViewBag.ProjectNames))
                    },
                    series : [
                        {
                            name: 'Task Percent',
                            type: 'pie',
                            radius : '55%',
                            center: ['50%', '50%'],
                            label: {
                                normal: {
                                    show: true,
                                    position: 'outside',
                                    formatter: '{b}:{d}%'//模板变量有 {a}、{b}、{c}、{d}，分别表示系列名，数据名，数据值，百分比。{d}数据会根据value值计算百分比
                                }
                            },
                            data: projectData,
                            itemStyle: {
                                emphasis: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                taskPercentChart.setOption(option);
            }

            function getTime() {
                var timeChart = echarts.init(document.getElementById('time'));
                // 指定图表的配置项和数据
                option = {
                    title: {
                        text: 'Time Spend Details',
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        }
                    },
                    legend: {
                        data: ['Last Month', 'This Month']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01]
                    },
                    yAxis: {
                        type: 'category',
                        data:  @Html.Raw(Json.Encode(ViewBag.ProjectNames))
                    },
                    series: [
                        {
                            name: 'Last Month',
                            type: 'bar',
                            data: @Html.Raw(Json.Encode(ViewBag.LastTimes)),
                            label: {
                                normal: {
                                    show: true,
                                    position: 'right'
                                }
                            }
                        },
                        {
                            name: 'This Month',
                            type: 'bar',
                            data: @Html.Raw(Json.Encode(ViewBag.CurrentTimes)),
                            label: {
                                normal: {
                                    show: true,
                                    position: 'right'
                                }
                            }
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                timeChart.setOption(option);
            }


            function getTimePercent() {
                var taskPercentChart = echarts.init(document.getElementById('time_percent'));
                var allTasks = @Html.Raw(Json.Encode(ViewBag.CurrentTimes));
                var allProjects =  @Html.Raw(Json.Encode(ViewBag.ProjectNames));
                projectData = [];
                for (var i = 0; i < allTasks.length; i++) {
                    var data = new Object();
                    data.name = allProjects[i];
                    data.value = allTasks[i];
                    projectData.push(data);
                }
                // 指定图表的配置项和数据
                option = {
                    title : {
                        text: 'Total Time',
                    },
                    tooltip : {
                        trigger: 'item',
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'right',
                        data:  @Html.Raw(Json.Encode(ViewBag.ProjectNames))
                    },
                    series : [
                        {
                            name: 'Task Percent',
                            type: 'pie',
                            radius : '55%',
                            center: ['50%', '50%'],
                            label: {
                                normal: {
                                    show: true,
                                    position: 'outside',
                                    formatter: '{b}:{d}%'//模板变量有 {a}、{b}、{c}、{d}，分别表示系列名，数据名，数据值，百分比。{d}数据会根据value值计算百分比
                                }
                            },
                            data: projectData,
                            itemStyle: {
                                emphasis: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                taskPercentChart.setOption(option);
            }

            getTask();
            getTaskPercent();
            getTime();
            getTimePercent();
</script>
